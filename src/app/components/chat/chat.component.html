@defer(when player) {
<div class="game-lobby-page-chat-container">
    <div class="section-title">
        <span>chat {{$onPlay() ? 'Missione' : 'Lobby'}} [public]</span>
        <div class="chat-log-actions">
            <button icon-button type="button" (click)="openChatHelpDialog()">
                <span title="chat commands help" class="material-symbols-outlined">info</span>
            </button>
            @if (player?.uid === mission?.createdBy) {
            <button icon-button type="button" (click)="openDeleteLogsDialog()">
                <span title="delete chat logs" class="material-symbols-outlined">delete</span>
            </button>
            }
        </div>

    </div>
    <div class="chat-content-container">
        <div class="chat-log">
            @for(log of mission?.chatLog; track $index) {
            <div class="{{log.class}} chat-message">[{{log.timestamp.toDate() | date:'d/M/yy HH:mm':'Europe/Rome'}}]
                {{log.senderPlayer}} "{{log.message}}"</div>
            } @empty {
            <p>No messages</p>
            }
        </div>
        <form [formGroup]="chatForm" class="chat-input">
            <span class="material-symbols-outlined">chevron_right</span>
            <input class="chat-log-input" type="text" formControlName="message" placeholder="Scrivi qui..."
                (keydown.enter)="sendMessage()" />
            <button icon-button class="material-symbols-outlined" type="button" (click)="sendMessage()"
                [disabled]="chatForm.invalid">keyboard_return</button>
        </form>
    </div>
</div>
} @placeholder {
<p>loading chat...</p>
}